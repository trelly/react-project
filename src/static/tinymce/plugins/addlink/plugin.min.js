tinymce.PluginManager.add('addlink', function(editor, url) {
    var panel = function(editor) {
        editor.windowManager.open({
            title: '插入链接',
            width: 428,
            height: 80,
            method: 'POST',
            body: [{
                label: '文章地址',
                type: 'textbox',
                name: "url"
            }],
            onsubmit: function(e) {
                e.preventDefault();
                $.post('/article/get_title_by_url/', {
                    url: e.data.url
                }).then(function(json) {
                    var link = '<a href=""' + json.data.url + '"">' + json.data.title + '</a>';
                    editor.insertContent(link);
                    eidtor.windowManager.close()
                }).fail(function(data) {
                    editor.notificationManager.open({
                        type: 'error',
                        text: '接口请求错误',
                        timeout: 2000
                    });
                })
            }
        })
    }
    editor.addButton('addlink', {
        icon: 'article',
        title: '插入文章',
        onclick: function() {
            panel(editor);
        }
    });
});
