tinymce.PluginManager.add('commodity', function(editor, url) {
    var panel = function(editor) {
        editor.windowManager.open({
            title: '添加商品',
            width: 428,
            height: 80,
            layout: 'flex',
      			direction: 'column',
      			align: 'stretch',
      			padding: 15,
      			spacing: 10,
      			items: [{
                label: '商品链接',
                type: 'textbox',
                name: "url",
                placeholder: '商品地址'
            }],
            onsubmit: function(e) {
                e.preventDefault();
                $.post('/article/get_title_by_url/', {
                    url: e.data.url
                }).then(function(json) {
                    var link = '<a href=""' + json.data.url + '"">' + json.data.title + '</a>';
                    editor.insertContent(link);
                    eidtor.windowManager.close()
                }).fail(function(data) {
                    editor.notificationManager.open({
                        type: 'error',
                        text: '接口请求错误',
                        timeout: 2000
                    });
                })
            }
        })
    };
    editor.addButton('commodity', {
        icon: 'commodity',
        title: '商品',
        onclick: function() {
            panel(editor);
        }
    });
});
