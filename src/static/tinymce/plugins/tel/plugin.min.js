tinymce.PluginManager.add('tel', function(editor, url) {
    function telValid(num) {
        var a = /^(0[0-9]{2,3}\-)?([2-9][0-9]{6,7})+(\-[0-9]{1,4})?$|(^(13[0-9]|15[0|3|6|7|8|9]|18[8|9])\d{8}$)/;
        return a.test(num);
    }
    var panel = function(editor) {
        editor.windowManager.open({
            title: '插入电话',
            width: 428,
            height: 80,
            method: 'POST',
            body: [{
                label: '电话号码',
                type: 'textbox',
                name: "telephone"
            }],
            onsubmit: function(e) {
                var telephone = e.data.telephone;
                if (telValid(telephone)) {
                    var telLink = '<em class="tele-ic"></em><a target="_blank" href="tel:'+telephone+'">' + telephone + '</a>';
                    editor.insertContent(telLink);
                } else {
                    editor.notificationManager.open({
                      text: '请输入有效的电话号码',
                      type: 'error',
                      timeout: 2000
                    });
                    e.preventDefault();
                }
            }
        })
    }
    editor.addButton('tel', {
        icon: 'tel',
        title: '电话',
        onclick: function() {
            panel(editor);
        }
    });
});
